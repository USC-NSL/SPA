diff -pu -r a/net/third_party/nss/ssl/sslsock.c b/net/third_party/nss/ssl/sslsock.c
--- a/net/third_party/nss/ssl/sslsock.c	2012-11-09 16:16:23.715038258 -0800
+++ b/net/third_party/nss/ssl/sslsock.c	2012-11-09 16:19:18.517565894 -0800
@@ -2906,11 +2906,15 @@ ssl_SetDefaultsFromEnvironment(void)
 	ev = getenv("SSLKEYLOGFILE");
 	if (ev && ev[0]) {
 	    ssl_keylog_iob = fopen(ev, "a");
-	    if (ftell(ssl_keylog_iob) == 0) {
-		fputs("# SSL/TLS secrets log file, generated by NSS\n",
-		      ssl_keylog_iob);
+	    if (!ssl_keylog_iob) {
+		SSL_TRACE(("Failed to open key log file"));
+	    } else {
+		if (ftell(ssl_keylog_iob) == 0) {
+		    fputs("# SSL/TLS secrets log file, generated by NSS\n",
+			  ssl_keylog_iob);
+		}
+		SSL_TRACE(("SSL: logging SSL/TLS secrets to %s", ev));
 	    }
-	    SSL_TRACE(("SSL: logging SSL/TLS secrets to %s", ev));
 	}
 #ifndef NO_PKCS11_BYPASS
 	ev = getenv("SSLBYPASS");
